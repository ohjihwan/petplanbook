<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HM010</title>
	<link rel="stylesheet" href="/assets/css/swiper.css">
	<link rel="stylesheet" href="/assets/css/common-ui.css">
	<link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>
	<div class="page">
		<div class="container">
			<header class="header">
				<!-- header.html ë¡œ í˜ì´ì§€ í†µí•© ê´€ë¦¬ -->
			</header>

			<main class="contents">
				<div class="content">
					
					<section class="main-banner">
						<figure class="img-box">
							<img src="/assets/imgs/img/img-HM010-3.jpg" alt="">
						</figure>
						<div class="text-box">
							<h2 class="title">ì–´ë””ë¡œ ê°ˆê¹Œìš”?</h2>
							<p class="txt">ì¶”ì²œ ì—¬í–‰ì§€ë¶€í„° ë°˜ë ¤ì¸ë“¤ì˜ í›„ê¸°ê¹Œì§€ í•œëˆˆì—!</p>
							<div class="guide-arrow" aria-label="í•˜ë‹¨ì— ì»¨í…ì¸ ê°€ ìˆìŠµë‹ˆë‹¤">
								<i></i>
								<i></i>
							</div>
						</div>
					</section>

					<section class="suggestion-place">
						<div class="inner">
							<div class="overflow-area">
								<div class="title-box">
									<h2 class="title">ì¶”ì²œ ëª©ì ì§€</h2>
									<p class="txt">ì¶”ì²œ ì¥ì†Œë¥¼ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤</p>
									<a href="../PL/PL010.html" class="button -primary" title="ì¥ì†Œ ì°¾ê¸° í˜ì´ì§€ë¡œ ì´ë™">ì¥ì†Œ ìì„¸íˆ ê²€ìƒ‰í•˜ê¸°</a>
								</div>
								<div class="place-area swiper-wrapper">
									
								</div>
								<div class="swiper-button-next"></div>
								<div class="swiper-button-prev"></div>
							</div>
						</div>
					</section>

					<section class="community-area">
						<div class="inner">
							<div class="title-box">
								<h2 class="title">ì¶”ì²œ ë£¨íŠ¸</h2>
								<p class="txt">ë°˜ë ¤ì¸ë“¤ì´ ìë‘í•˜ëŠ” ë£¨íŠ¸ì™€ ë‹¤ë…€ì˜¨ í›„ê¸°ë¥¼ êµ¬ê²½í•˜ì„¸ìš”</p>
							</div>
							<div class="communitys">
								<div class="unit">
									<a href="../CO/CO030.html">
										<div class="img-box">
											<img src="/assets/imgs/temp/temp-list1.jpg" alt="">
										</div>
										<div class="txt-box">
											<p class="main-txt">ì—¬íƒœ ê°€ë³¸ë° ì¤‘ì— ì—¬ê¸° ìµœê³ ì¸ê±° ê°™ì•„ìš”</p>
											<p class="sub-txt -ellipsis-2">
												ê¹€ì•„ë¬´ê°œ Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae molestias tenetur sed, quidem perferendis quas ex error? Odit ducimus rem dolor, debitis maiores, porro excepturi, nihil sit nobis reprehenderit voluptate.
											</p>
										</div>
										<span class="name">ì¹´ë¦¬ë‚˜</span>
									</a>
								</div>
								<div class="unit">
									<a href="../CO/CO030.html">
										<div class="img-box">
											<img src="/assets/imgs/temp/temp-list1.jpg" alt="">
										</div>
										<div class="txt-box">
											<p class="main-txt">ì—¬íƒœ ê°€ë³¸ë° ì¤‘ì— ì—¬ê¸° ìµœê³ ì¸ê±° ê°™ì•„ìš”</p>
											<p class="sub-txt -ellipsis-2">
												ì§„ì§œë¡œ ì¹œì ˆí•˜ì‹œêµ¬, ì¹œêµ¬ë‘ ê°™ì´ ê°€ê¸°ì—ë„ êµ¿!!
											</p>
										</div>
										<span class="name">ì¹´ë¦¬ë‚˜</span>
									</a>
								</div>
								<div class="unit">
									<a href="../CO/CO030.html">
										<div class="img-box">
											<img src="/assets/imgs/temp/temp-list1.jpg" alt="">
										</div>
										<div class="txt-box">
											<p class="main-txt">ì—¬íƒœ ê°€ë³¸ë° ì¤‘ì— ì—¬ê¸° ìµœê³ ì¸ê±° ê°™ì•„ìš”</p>
											<p class="sub-txt -ellipsis-2">
												ì§„ì§œë¡œ ì¹œì ˆí•˜ì‹œêµ¬, ì¹œêµ¬ë‘ ê°™ì´ ê°€ê¸°ì—ë„ êµ¿!!
											</p>
										</div>
										<span class="name">ì¹´ë¦¬ë‚˜</span>
									</a>
								</div>
								<div class="unit">
									<a href="../CO/CO030.html">
										<div class="img-box">
											<img src="/assets/imgs/temp/temp-list1.jpg" alt="">
										</div>
										<div class="txt-box">
											<p class="main-txt">ì—¬íƒœ ê°€ë³¸ë° ì¤‘ì— ì—¬ê¸° ìµœê³ ì¸ê±° ê°™ì•„ìš”</p>
											<p class="sub-txt -ellipsis-2">
												ì§„ì§œë¡œ ì¹œì ˆí•˜ì‹œêµ¬, ì¹œêµ¬ë‘ ê°™ì´ ê°€ê¸°ì—ë„ êµ¿!!
											</p>
										</div>
										<span class="name">ì¹´ë¦¬ë‚˜</span>
									</a>
								</div>
							</div>
						</div>
					</section>

					<section class="celebrity-area">
						<div class="inner">
							<div class="title-box">
								<h2 class="title">ì»¤ë®¤ë‹ˆí‹° ì¸ê¸° ë£¨íŠ¸</h2>
								<p class="txt">ë°˜ë ¤ì¸ë“¤ì˜ ì—¬í–‰ ê¸°ë¡ì„ ì‚´í´ë³¼ê¹Œìš”?</p>
							</div>
							
							<div class="celebrity-people">
								<ul>
									<li>
										<a href="../CO/CO050.html" class="link">
											<div class="ratings">
												<i class="ico -rating"></i>268
											</div>
											<figure class="img-box">
												<img src="/assets/imgs/temp/temp-People1.jpg" alt="">
											</figure>
											<span class="pet-user">
												<span class="pet">ë½€ì‚</span>ì˜ ë™ë°˜ì
												<span class="user">ì¹´ë¦¬ë‚˜</span>ë‹˜
											</span>
										</a>
									</li>
									<li>
										<a href="../CO/CO050.html" class="link">
											<div class="ratings">
												<i class="ico -rating"></i>268
											</div>
											<figure class="img-box">
												<img src="/assets/imgs/temp/temp-People2.jpg" alt="">
											</figure>
											<span class="pet-user">
												<span class="pet">ë‚˜ë¹„</span>ì˜ ë™ë°˜ì
												<span class="user">ë°•ì˜ìˆ˜</span>ë‹˜
											</span>
										</a>
									</li>
									<li>
										<a href="../CO/CO050.html" class="link">
											<div class="ratings">
												<i class="ico -rating"></i>268
											</div>
											<figure class="img-box">
												<img src="/assets/imgs/temp/temp-People3.jpg" alt="">
											</figure>
											<span class="pet-user">
												<span class="pet">ìª¼ê¼¬,í¬ë¦¼</span>ì˜ ë™ë°˜ì
												<span class="user">íƒœë¦¬</span>ë‹˜
											</span>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</section>

				</div>
			</main>

			<footer class="footer">
				<!-- footer.html ë¡œ í˜ì´ì§€ í†µí•© ê´€ë¦¬ -->
			</footer>
		</div>
	</div>

	<div id="login-modal" class="modal -login-modal"></div>

	<div id="detail" class="modal">
		<div class="container">
			<header class="header">
				<div class="inner">
				<button type="button" class="close" onclick="modalClose()">
					<span class="hide">ë‹«ê¸°</span>
				</button>
				</div>
			</header>

			<main class="contents">
				<div class="content">
				<div class="location-detail">
					<div class="title-box">
					<h2 class="title">ì¥ì†Œ ìì„¸íˆ</h2>
					<p class="txt">ìì„¸íˆ ì½ê³ ë‚˜ì„œ ì €ì¥í•´ë³´ì„¸ìš”</p>
					</div>

					<div class="detail-imgs swiper detail-imgs">
					<div class="swiper-wrapper"></div>
					<div class="swiper-button-next"></div>
					<div class="swiper-button-prev"></div>
					</div>

					<dl class="details">
					<dt>ìƒí˜¸ì´ë¦„</dt>
					<dd></dd>
					<dt>ìƒì„¸ì£¼ì†Œ</dt>
					<dd></dd>
					<dt>ëŒ€í‘œë²ˆí˜¸</dt>
					<dd></dd>
					<dt>ì¹´í…Œê³ ë¦¬</dt>
					<dd></dd>
					</dl>
				</div>
				</div>
			</main>

			<div class="fixed">
				<div class="buttons">
				<button
					type="button"
					class="button -primary -lg"
					onclick="savePlace()"
				>
					ì´ ì¥ì†Œ ì €ì¥í•˜ê¸°
				</button>
				</div>
			</div>
		</div>
	</div>
	<script src="/assets/libs/jquery/jquery-3.6.0.min.js"></script>
	<script src="/assets/libs/jquery-ui/jquery-ui.min.js"></script>
	<script src="/assets/libs/jquery-ui/jquery.ui.touch-punch.min.js"></script>
	<script src="/assets/libs/swiper/dist/js/swiper.min.js"></script>
	<script src="/assets/js/style.js"></script>
	<script src="/assets/js/dev.js"></script>
	<script>
		// âœ… ì´ë¯¸ì§€ ë¡œë“œ í™•ì¸ í•¨ìˆ˜ (ë¹„ë™ê¸°)
		async function checkImageLoad(url) {
			return new Promise((resolve) => {
				const img = new Image();
				img.src = url;
				img.onload = () => resolve(true);
				img.onerror = () => resolve(false);
			});
		}

		// âœ… ì¹´í…Œê³ ë¦¬ ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤ ì§€ì • í•¨ìˆ˜
		function getCategoryClassByType(category) {
			if (category.includes("ìˆ™ë°•")) return "lodging";
			if (category.includes("ìŒì‹ì ") || category.includes("ì¹´í˜")) return "cafe";
			if (category.includes("ë†€ê±°ë¦¬")) return "activity";
			return "etc";
		}

		// âœ… ë©”ì¸ í˜ì´ì§€ì—ì„œ Swiper ìŠ¬ë¼ì´ë“œ í´ë¦­ ì‹œ ëª¨ë‹¬ íŒì—…
		async function loadRecommendedPlaces() {
			try {
				const apiUrl = "https://apis.data.go.kr/B551011/KorPetTourService/areaBasedList?serviceKey=GTr1cI7Wi0FRbOTFBaUzUCzCDP4OnyyEmHnn11pxCUC5ehG5bQnbyztgeydnOWz1O04tjw1SE5RsX8RNo6XCgQ%3D%3D&numOfRows=50&pageNo=1&MobileOS=ETC&MobileApp=AppTest&_type=json";
				
				const response = await fetch(apiUrl, {
					headers: {
						"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
					}
				});

				const data = await response.json();
				let places = data.response.body.items.item;
				console.log("âœ… ì „ì²´ ì¥ì†Œ ìˆ˜:", places.length);

				// âœ… ì¡°íšŒìˆ˜ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
				places.sort((a, b) => (b.readcount || 0) - (a.readcount || 0));
				places = places.slice(0, 50);

				const placeArea = document.querySelector(".place-area");
				placeArea.innerHTML = ""; // ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ ì´ˆê¸°í™”
			
				const categorizedPlaces = {
					"ğŸ¨ ìˆ™ë°•": [],
					"â˜•ğŸ´ ìŒì‹ì ": [],
					"ğŸ¢ ë†€ê±°ë¦¬": [],
					"ğŸ“Œ ê¸°íƒ€": []
				};
				
				// âœ… ì¥ì†Œ ë¶„ë¥˜ ë° ì´ë¯¸ì§€ ë¡œë“œ í™•ì¸
				for (const place of places) {
					const imageUrl = place.firstimage;
					const type = place.contenttypeid;
					if (!imageUrl) continue;

					const image = await checkImageLoad(imageUrl);
					if (!image) continue;

					const category = getCategoryByType(type);
					categorizedPlaces[category].push(place);
				}

				// âœ… ê° ì¹´í…Œê³ ë¦¬ì—ì„œ ëœë¤í•˜ê²Œ ìµœëŒ€ 2ê°œì”© ì„ íƒ
				Object.keys(categorizedPlaces).forEach(category => {
					const shuffledPlaces = shuffleArray(categorizedPlaces[category]);
					shuffledPlaces.slice(0, 2).forEach(place => {
						const slide = document.createElement("a");
						slide.href = "javascript:void(0)";
						slide.classList.add("place", "swiper-slide");
						slide.onclick = () => openDetailModal(place); // âœ… í´ë¦­ ì´ë²¤íŠ¸ ì§ì ‘ ì¶”ê°€

						const categoryClass = getCategoryClassByType(category);
						slide.innerHTML = `
							<div class="img-box">
								<img src="${place.firstimage}" alt="${place.title}">
							</div>
							<div class="place-info">
								<h3 class="main-txt">${place.title}</h3>
								<span class="sub-txt">ì£¼ì†Œ : ${place.addr1 || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}</span>
							</div>
							<div class="category ${categoryClass}">${category}</div>
						`;

						placeArea.appendChild(slide);
					});
				});

				console.log("âœ… ë¡œë“œëœ ì¥ì†Œ ìˆ˜:", placeArea.children.length);

				// âœ… ë¡œë“œëœ ìŠ¬ë¼ì´ë“œê°€ ìˆì„ ë•Œë§Œ Swiper ì´ˆê¸°í™”
				if (placeArea.children.length > 0) {
					initializeSwiper();
				} else {
					console.warn("âš ï¸ ì¶”ì²œ ì¥ì†Œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				}
			} catch (error) {
				console.error("ğŸ”¥ ì¶”ì²œ ì¥ì†Œ ë¡œë“œ ì˜¤ë¥˜:", error);
			}
		}

		// âœ… Swiper ì´ˆê¸°í™” í•¨ìˆ˜
		function initializeSwiper() {
			if (window.mainSuggestionSwiper) {
				window.mainSuggestionSwiper.destroy(true, true);
				window.mainSuggestionSwiper = null;
			}

			window.mainSuggestionSwiper = new Swiper(".suggestion-place .overflow-area", {
				slideClass: "place",
				observer: true,
				observerParents: true,
				loop: true,
				autoplay: {
					delay: 2500,
					disableOnInteraction: false
				},
				speed: 500,
				effect: "coverflow",
				centeredSlides: true,
				slidesPerView: "auto",
				coverflowEffect: {
					rotate: 15,
					depth: 100,
					modifier: 2,
					slideShadows: true,
				},
				navigation: {
					nextEl: ".swiper-button-next",
					prevEl: ".swiper-button-prev",
				},
			});
		}

		// âœ… ëª¨ë‹¬ íŒì—… ì—´ê¸°
		function openDetailModal(place) {
			document.querySelector("#detail .details dd:nth-of-type(1)").textContent = place.title || "-";
			document.querySelector("#detail .details dd:nth-of-type(2)").textContent = place.addr1 || "-";
			document.querySelector("#detail .details dd:nth-of-type(3)").textContent = place.tel || "-";
			document.querySelector("#detail .details dd:nth-of-type(4)").textContent = place.category || "-";

			// ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ
			const swiperWrapper = document.querySelector("#detail .swiper-wrapper");
			swiperWrapper.innerHTML = `<div class="swiper-slide"><img src="${place.firstimage || '/assets/imgs/temp/temp1.png'}" alt=""></div>`;

			new Swiper(".detail-imgs", {
				navigation: {
					nextEl: ".swiper-button-next",
					prevEl: ".swiper-button-prev"
				}
			});

			document.getElementById("detail").style.display = "block";
		}

		// âœ… ëª¨ë‹¬ ë‹«ê¸°
		function modalClose() {
			document.getElementById("detail").style.display = "none";
		}

		// âœ… ëœë¤ ì„ê¸° í•¨ìˆ˜
		function shuffleArray(array) {
			return array.sort(() => Math.random() - 0.5);
		}

		// âœ… ì¹´í…Œê³ ë¦¬ ë¼ë²¨ ì§€ì • í•¨ìˆ˜ (contenttypeid ê¸°ì¤€)
		function getCategoryByType(type) {
			if (type == 32) return "ğŸ¨ ìˆ™ë°•";
			if (type == 39) return "â˜•ğŸ´ ìŒì‹ì ";
			if (type == 12 || type == 28) return "ğŸ¢ ë†€ê±°ë¦¬";
			return "ğŸ“Œ ê¸°íƒ€";
		}

		// âœ… í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
		document.addEventListener("DOMContentLoaded", loadRecommendedPlaces);

	</script>
</body>
</html>